/*! Ajax-Include - v0.1.1 - 2013-06-06
* http://filamentgroup.com/lab/ajax_includes_modular_content/
* Copyright (c) 2013 @scottjehl, Filament Group, Inc.; Licensed MIT */
(function(e,t){e.fn.ajaxInclude=function(t){function a(t){var n=t.data("url");u.proxy&&e.inArray(n,r)===-1?(r.push(n),i=i.add(t)):f(t.data("url"),t)}function f(t,n,r){if(r&&n[0].tagName.toLowerCase()==="form"){if(!e.prototype.serialize)throw new Error("$.fn.serialize required for ajaxInclude on forms.");var i=(n.attr("method")||"").toLowerCase()==="post"?"post":"get",s=n.serialize();e[i](t,s,function(e){n.trigger("ajaxIncludeResponse",[e])})}else e.get(t,function(e){n.trigger("ajaxIncludeResponse",[e])})}function l(){r.length&&(f(u.proxy+r.join(","),i),i=e(),r=[])}function c(e,t){function i(){a(e),l(),r.removeListener(i)}var r=n.matchMedia(t);r.addListener&&r.addListener(i)}var n=window,r=[],i=e(),s="data-ajax-bound",o="data-interaction",u={proxy:null};return typeof t=="string"?u.proxy=t:u=e.extend(u,t),this.not("["+s+"],["+o+"]").each(function(t){var r=e(this),i=r.attr("data-media"),o=["append","replace","before","after"],l,h,p=!1,d=r.attr("data-target");for(var v=o.length,m=0;m<v;m++)r.is("[data-"+o[m]+"]")&&(l=o[m],h=r.attr("data-"+l));h||(h=r.attr("href")||r.attr("action"),p=!0),l==="replace"&&(l+="With"),r.data("method",l).data("url",h).data("target",d).attr(s,!0).bind("ajaxIncludeResponse",function(t,n){var i=n,s=d?e(d):r;if(u.proxy){var o=i.match(new RegExp("<entry url=[\"']?"+r.data("url")+"[\"']?>(?:(?!</entry>)(.|\n))*","gmi"));o&&(i=o[0])}var a=r.triggerHandler("ajaxIncludeFilter",[i]);a&&(i=a),l==="replaceWith"?(r.trigger("ajaxInclude",[i]),s[r.data("method")](i)):(s[r.data("method")](i),r.trigger("ajaxInclude",[i]))}),p?f(h,r,!0):!i||n.matchMedia&&n.matchMedia(i).matches?a(r):i&&n.matchMedia&&c(r,i)}),l(),this}})(jQuery);